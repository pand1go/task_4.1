### [*>>> к содержанию*](./readme.md)
### [*> следующая страница*](./git_reset%24git_restore.md)
### [*предыдущая страница <*](./git_clean.md)

---

# **Игнорирование файлов**

#### Зачастую, у вас имеется группа файлов, которые вы не только не хотите автоматически добавлять в репозиторий, но и видеть в списках неотслеживаемых. К таким файлам обычно относятся автоматически генерируемые файлы (различные логи, результаты сборки программ и т. п.). В таком случае, вы можете создать файл `.gitignore`. с перечислением шаблонов соответствующих таким файлам. Вот пример файла `.gitignore`:
<pre>
$ cat .gitignore
*.[oa]
*~
</pre>
#### Первая строка предписывает Git игнорировать любые файлы заканчивающиеся на «.o» или «.a» — объектные и архивные файлы, которые могут появиться во время сборки кода. Вторая строка предписывает игнорировать все файлы заканчивающиеся на тильду (`~`), которая используется во многих текстовых редакторах, например Emacs, для обозначения временных файлов. Вы можете также включить каталоги log, tmp или pid; автоматически создаваемую документацию; и т. д. и т. п. Хорошая практика заключается в настройке файла `.gitignore` до того, как начать серьёзно работать, это защитит вас от случайного добавления в репозиторий файлов, которых вы там видеть не хотите.
#### Git рассматривает каждый файл в вашей рабочей копии как файл одного из трех нижеуказанных типов.
1. #### Отслеживаемый файл — файл, который был предварительно проиндексирован или зафиксирован в коммите.
2. #### Неотслеживаемый файл — файл, который не был проиндексирован или зафиксирован в коммите.
3. #### Игнорируемый файл — файл, явным образом помеченный для Git как файл, который необходимо игнорировать.
#### **Игнорируемые файлы** — это, как правило, артефакты сборки и файлы, генерируемые машиной из исходных файлов в вашем репозитории, либо файлы, которые по какой-либо иной причине не должны попадать в коммиты. Вот некоторые распространенные примеры таких файлов:
* #### кэши зависимостей, например содержимое `/node_modules` или `/packages`;
* #### скомпилированный код, например файлы `.o`, `.pyc` и `.class`;
* #### каталоги для выходных данных сборки, например `/bin`, `/out` или `/target`;
* #### файлы, сгенерированные во время выполнения, например `.log`, `.lock` или `.tmp`;
* #### скрытые системные файлы, например `.DS_Store` или `Thumbs.db`;
* #### личные файлы конфигурации IDE, например `.idea/workspace.xml`.
#### К шаблонам в файле `.gitignore` применяются следующие правила:
* #### Пустые строки, а также строки, начинающиеся с `#`, игнорируются.
* #### Стандартные шаблоны являются глобальными и применяются рекурсивно для всего дерева каталогов.
* #### Чтобы избежать рекурсии используйте символ слеш (/) в начале шаблона.
* #### Чтобы исключить каталог добавьте слеш (/) в конец шаблона.
* #### Можно инвертировать шаблон, использовав восклицательный знак (!) в качестве первого символа.

#### Glob-шаблоны представляют собой упрощённые регулярные выражения, используемые командными интерпретаторами. Символ (`*`) соответствует 0 или более символам; последовательность `[abc]` — любому символу из указанных в скобках (в данном примере a, b или c); знак вопроса (`?`) соответствует одному символу; и квадратные скобки, в которые заключены символы, разделённые дефисом (`[0-9]`), соответствуют любому символу из интервала (в данном случае от 0 до 9). Вы также можете использовать две звёздочки, чтобы указать на вложенные каталоги: `a/**/z` соответствует `a/z`, `a/b/z`, `a/b/c/z`, и так далее.
#### Вот ещё один пример файла `.gitignore`:
<pre>
# Исключить все файлы с расширением .a
*.a

# Но отслеживать файл lib.a даже если он подпадает под исключение выше
!lib.a

# Исключить файл TODO в корневом каталоге, но не файл в subdir/TODO
/TODO

# Игнорировать все файлы в каталоге build/
build/

# Игнорировать файл doc/notes.txt, но не файл doc/server/arch.txt
doc/*.txt

# Игнорировать все .txt файлы в каталоге doc/
doc/**/*.txt
</pre>

<table>
    <tr>
        <td> <h4> <strong> Подсказка </strong> </h4> </td>
        <td> <h4> <a href="https://github.com/github/gitignore">GitHub</a> поддерживает довольно полный список примеров .gitignore файлов для множества проектов и языков  это может стать отправной точкой для <code>.gitignore</code> в вашем проекте. </h4> </td>
    </tr>
    <tr>
        <td> <h4> <strong> Примечание </strong> </h4> </td>
        <td> <h4> В простейшем случае репозиторий будет иметь один файл <code>.gitignore</code> в корневом каталоге, правила из которого будут рекурсивно применяться ко всем подкаталогам. Так же возможно использовать <code>.gitignore</code> файлы в подкаталогах. Правила из этих файлов будут применяться только к каталогам, в которых они находятся. Например, репозиторий исходного кода ядра Linux содержит 206 файлов <code>.gitignore.</code> </h4> </td>
    </tr>
</table>

---

## **Шаблоны игнорирования в Git**

---

<table>
    <tr>
        <th> <h4> <strong> Шаблон </strong> </h4> </th>
        <th> <h4> <strong> Примеры соответствия </strong> </h4> </th>
        <th> <h4> <strong> Пояснения </strong> <h4> </th>
    </tr>
    <tr>
        <td> <h4> **/logs </h4> </td>
        <td> <h4> logs/debug.log <br> logs/monday/foo.bar <br> build/logs/debug.log </h4> </td>
        <td> <h4> Добавьте в начало шаблона две звездочки, чтобы сопоставлять каталоги в любом месте репозитория. </h4> </td>
    </tr>
    <tr>
        <td> <h4> **/logs/debug.log </h4> </td>
        <td> <h4> logs/debug.log <br> build/logs/debug.log <br> но не <br> logs/build/debug.log </h4> </td>
        <td> <h4> Две звездочки можно также использовать для сопоставления файлов на основе их имени и имени родительского каталога. </h4> </td>
    </tr>
    <tr>
        <td> <h4> *.log </h4> </td>
        <td> <h4> debug.log <br> foo.log <br> .log <br> logs/debug.log </h4> </td>
        <td> <h4> Одна звездочка — это подстановочный знак, который может соответствовать как нескольким символам, так и ни одному. </h4> </td>
    </tr>
    <tr>
        <td> <h4> *.log <br> !important.log </h4> </td>
        <td> <h4> debug.log <br> trace.log <br> но не <br> important.log <br> logs/important.log </h4> </td>
        <td> <h4> Добавление восклицательного знака в начало шаблона отменяет действие шаблона. Если файл соответствует некоему шаблону, но при этом также соответствует отменяющему шаблону, указанному после, такой файл не будет игнорироваться. </h4> </td>
    </tr>
    <tr>
        <td> <h4> *.log <br> !important/*.log <br> trace.* </h4> </td>
        <td> <h4> debug.log <br> important/trace.log <br> но не <br> important/debug.log </h4> </td>
        <td> <h4> Шаблоны, указанные после отменяющего шаблона, снова будут помечать файлы как игнорируемые, даже если ранее игнорирование этих файлов было отменено. </h4> </td>
    </tr>
    <tr>
        <td> <h4> /debug.log </h4> </td>
        <td> <h4> debug.log <br> но не <br> logs/debug.log </h4> </td>
        <td> <h4> Косая черта перед именем файла соответствует файлу в корневом каталоге репозитория. </h4> </td>
    </tr>
    <tr>
        <td> <h4> debug.log </h4> </td>
        <td> <h4> debug.log <br> logs/debug.log </h4> </td>
        <td> <h4> По умолчанию шаблоны соответствуют файлам, находящимся в любом каталоге. </h4> </td>
    </tr>
    <tr>
        <td> <h4> debug?.log </h4> </td>
        <td> <h4> debug0.log <br> debugg.log <br> но не <br> debug10.log </h4> </td>
        <td> <h4> Знак вопроса соответствует строго одному символу. </h4> </td>
    </tr>
    <tr>
        <td> <h4> debug[0-9].log </h4> </td>
        <td> <h4> debug0.log <br> debug1.log <br> но не <br> debug10.log </h4> </td>
        <td> <h4> Квадратные скобки можно также использовать для указания соответствия одному символу из заданного диапазона. </h4> </td>
    </tr>
    <tr>
        <td> <h4> debug[01].log </h4> </td>
        <td> <h4> debug0.log <br> debug1.log <br> но не <br> debug2.log <br> debug01.log </h4> </td>
        <td> <h4> Квадратные скобки соответствуют одному символу из указанного набора. </h4> </td>
    </tr>
    <tr>
        <td> <h4> debug[!01].log </h4> </td>
        <td> <h4> debug2.log <br> но не <br> debug0.log <br> debug1.log <br> debug01.log </h4> </td>
        <td> <h4> Восклицательный знак можно использовать для указания соответствия любому символу, кроме символов из указанного набора. </h4> </td>
    </tr>
    <tr>
        <td> <h4> debug[a-z].log </h4> </td>
        <td> <h4> debuga.log <br> debugb.log <br> но не <br> debug1.log </h4> </td>
        <td> <h4> Диапазоны могут быть цифровыми или буквенными. </h4> </td>
    </tr>
    <tr>
        <td> <h4> logs </h4> </td>
        <td> <h4> logs <br> logs/debug.log <br> logs/latest/foo.bar <br> build/logs <br> build/logs/debug.log </h4> </td>
        <td> <h4> Без косой черты в конце этот шаблон будет соответствовать и файлам, и содержимому каталогов с таким именем. В примере соответствия слева игнорируются и каталоги, и файлы с именем logs </h4> </td>
    </tr>
    <tr>
        <td> <h4> logs/ </h4> </td>
        <td> <h4> logs/debug.log <br> logs/latest/foo.bar <br> build/logs/foo.bar <br> build/logs/latest/debug.log </h4> </td>
        <td> <h4> Косая черта в конце шаблона означает каталог. Все содержимое любого каталога репозитория, соответствующего этому имени (включая все его файлы и подкаталоги), будет игнорироваться. </h4> </td>
    </tr>
    <tr>
        <td> <h4> logs/ <br> !logs/important.log </h4> </td>
        <td> <h4> logs/debug.log <br> logs/important.log </h4> </td>
        <td> <h4> Из-за странностей Git, связанных с производительностью, вы не можете отменить игнорирование файла, которое задано шаблоном соответствия каталогу. </h4> </td>
    </tr>
    <tr>
        <td> <h4> logs/**/debug.log </h4> </td>
        <td> <h4> logs/debug.log <br> logs/monday/debug.log <br> logs/monday/pm/debug.log </h4> </td>
        <td> <h4> Две звездочки соответствуют множеству каталогов или ни одному. </h4> </td>
    </tr>
    <tr>
        <td> <h4> logs/*day/debug.log </h4> </td>
        <td> <h4> logs/monday/debug.log <br> logs/tuesday/debug.log <br> но не <br> logs/latest/debug.log </h4> </td>
        <td> <h4> Подстановочные символы можно использовать и в именах каталогов. </h4> </td>
    </tr>
    <tr>
        <td> <h4> logs/debug.log </h4> </td>
        <td> <h4> logs/debug.log <br> но не <br> debug.log <br> build/logs/debug.log </h4> </td>
        <td> <h4> Шаблоны, указывающие на файл в определенном каталоге, задаются относительно корневого каталога репозитория. (При желании можно добавить в начало косую черту, но она ни на что особо не повлияет.) </h4> </td>
    </tr>
</table>

#### Две звездочки (\*\*) означают, что ваш файл `.gitignore` находится в каталоге верхнего уровня вашего репозитория, как указано в соглашении. Если в репозитории несколько файлов `.gitignore`, просто мысленно поменяйте слова «корень репозитория» на «каталог, содержащий файл .gitignore» (и подумайте об объединении этих файлов, чтобы упростить работу для своей команды)*.
#### Помимо указанных символов, можно использовать символ `#`, чтобы добавить в файл `.gitignore` комментарии:
<pre>
# ignore all logs
*.log
</pre>
#### Если у вас есть файлы или каталоги, в имени которых содержатся спецсимволы шаблонов, для экранирования этих спецсимволов в `.gitignore` можно использовать обратную косую черту (\\):
<pre>
# ignore the file literally named foo[01].txt
foo\[01\].txt
</pre>

---

## **Общие файлы .gitignore в вашем репозитории**

---

#### Обычно правила игнорирования Git задаются в файле `.gitignore` в корневом каталоге репозитория. Тем не менее вы можете определить несколько файлов `.gitignore` в разных каталогах репозитория. Каждый шаблон из конкретного файла `.gitignore` проверяется относительно каталога, в котором содержится этот файл. Однако проще всего (и этот подход рекомендуется в качестве общего соглашения) определить один файл `.gitignore` в корневом каталоге. После регистрации файла `.gitignore` для него, как и для любого другого файла в репозитории, включается контроль версий, а после публикации с помощью команды push он становится доступен остальным участникам команды. В файл `.gitignore`, как правило, включаются только те шаблоны, которые будут полезны другим пользователям репозитория.

---

## **Персональные правила игнорирования в Git**

---

#### В специальном файле, который находится в папке `.git/info/exclude`, можно определить персональные шаблоны игнорирования для конкретного репозитория. Этот файл не имеет контроля версий и не распространяется вместе с репозиторием, поэтому он хорошо подходит для указания шаблонов, которые будут полезны только вам. Например, если у вас есть пользовательские настройки для ведения журналов или специальные инструменты разработки, которые создают файлы в рабочем каталоге вашего репозитория, вы можете добавить их в `.git/info/exclude`, чтобы они случайно не попали в коммит в вашем репозитории.

---

## **Глобальные правила игнорирования в Git**

---

#### Кроме того, для всех репозиториев в локальной системе можно определить глобальные шаблоны игнорирования Git, настроив параметр конфигурации Git `core.excludesFile `. Этот файл нужно создать самостоятельно. Если вы не знаете, куда поместить глобальный файл `.gitignore`, расположите его в домашнем каталоге (потом его будет легче найти). После создания этого файла необходимо настроить его местоположение с помощью команды `git config`:
<pre>
$ touch ~/.gitignore
$ git config --global core.excludesFile ~/.gitignore
</pre>
#### Будьте внимательны при указании глобальных шаблонов игнорирования, поскольку для разных проектов актуальны различные типы файлов. Типичные кандидаты на глобальное игнорирование — это специальные файлы операционной системы (например, `.DS_Store` и `thumbs.db`) или временные файлы, создаваемые некоторыми инструментами разработки.

---

## **Игнорирование ранее закоммиченного файла**

---

#### Чтобы игнорировать файл, для которого ранее был сделан коммит, необходимо удалить этот файл из репозитория, а затем добавить для него правило в `.gitignore`. Используйте команду `git rm` с параметром `--cached`, чтобы удалить этот файл из репозитория, но оставить его в рабочем каталоге как игнорируемый файл.
<pre>
$ echo debug.log >> .gitignore
  
$ git rm --cached debug.log
rm 'debug.log'
  
$ git commit -m "Start ignoring debug.log"
</pre>
#### Опустите опцию `--cached`, чтобы удалить файл как из репозитория, так и из локальной файловой системы.

---

## **Коммит игнорируемого файла**

---

#### Можно принудительно сделать коммит игнорируемого файла в репозиторий с помощью команды `git add` с параметром `-f` (или `--force`):
<pre>
$ cat .gitignore
*.log
  
$ git add -f debug.log
  
$ git commit -m "Force adding debug.log"
</pre>
#### Этот способ хорош, если у вас задан общий шаблон (например, `*.log`), но вы хотите сделать коммит определенного файла. Однако еще лучше в этом случае задать исключение из общего правила:
<pre>
$ echo !debug.log >> .gitignore
  
$ cat .gitignore
*.log
!debug.log
  
$ git add debug.log
  
$ git commit -m "Adding debug.log"
</pre>
#### Этот подход более прозрачен и понятен, если вы работаете в команде.

---

## **Отладка файлов .gitignore**

---

#### Если шаблоны `.gitignore` сложны или разбиты на множество файлов `.gitignore`, бывает непросто отследить, почему игнорируется определенный файл. Используйте команду `git check-ignore` с параметром `-v` (или `--verbose`), чтобы определить, какой шаблон приводит к игнорированию конкретного файла:
<pre>
$ git check-ignore -v debug.log
.gitignore:3:*.log  debug.log
</pre>
#### Вывод показывает:
<pre>
&ltfile containing the pattern&gt : &ltline number of the pattern&gt : &ltpattern&gt   &ltfile name&gt
</pre>
#### При желании команде `git check-ignore` можно передать несколько имен файлов, причем сами имена могут даже не соответствовать файлам, существующим в вашем репозитории.

---

### [*>>> к содержанию*](./readme.md)
### [*> следующая страница*](./git_reset%24git_restore.md)
### [*предыдущая страница <*](./git_clean.md)